<!-- Main Container with Full Width Layout -->
<div class="w-full mx-auto flex flex-col lg:flex-row gap-6 mb-8">
  
  <!-- Left Side - Prediction Form Card -->
<section class="prediction-form-container w-full lg:w-3/5 bg-white rounded-lg shadow-lg p-4 sm:p-6">
    <div class="text-center sm:text-left">
      <h1 class="text-2xl sm:text-3xl font-bold text-emerald-700 mb-2 sm:mb-4">Environmental Indicators Prediction</h1>
      <p class="text-sm sm:text-base text-gray-600 mb-4 sm:mb-6">Use this tool to predict the evolution of environmental and sustainability indicators.</p>
    </div>

    <form [formGroup]="predictionForm" (ngSubmit)="onSubmit()" class="space-y-4 sm:space-y-6">
      <!-- Indicator Type -->
      <div class="form-group">
        <label for="metric_type" class="block text-sm font-medium text-gray-700 mb-1">Indicator Type</label>
        <select
          id="metric_type"
          formControlName="metric_type"
          class="w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-md focus:outline-none transition-all duration-200"
          required
        >
          <option value="" disabled>-- Select an indicator --</option>
          <option *ngFor="let type of metricTypes" [value]="type.value">{{ type.label }}</option>
        </select>
        <div *ngIf="predictionForm.get('metric_type')?.invalid && predictionForm.get('metric_type')?.touched" class="text-red-500 text-xs sm:text-sm mt-1">
          Please select an indicator type
        </div>
      </div>

      <!-- Entity -->
      <div class="form-group">
        <label for="entity_id" class="block text-sm font-medium text-gray-700 mb-1">Entity</label>
        <select
          id="entity_id"
          formControlName="entity_id"
          class="w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-md focus:outline-none transition-all duration-200"
        >
          <option value="">All entities</option>
          <option *ngFor="let entity of entities" [value]="entity">{{ entity }}</option>
        </select>
      </div>

      <!-- Dates -->
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4">
        <div class="form-group">
          <label for="start_date" class="block text-sm font-medium text-gray-700 mb-1">Start Date</label>
          <input
            type="date"
            id="start_date"
            formControlName="start_date"
            class="w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-md focus:outline-none transition-all duration-200"
          >
        </div>

        <div class="form-group">
          <label for="end_date" class="block text-sm font-medium text-gray-700 mb-1">End Date</label>
          <input
            type="date"
            id="end_date"
            formControlName="end_date"
            class="w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-md focus:outline-none transition-all duration-200"
          >
        </div>
      </div>

      <!-- Periods -->
      <div class="form-group">
        <label for="periods" class="block text-sm font-medium text-gray-700 mb-1">Prediction Period (days)</label>
        <div class="flex items-center">
          <input
            type="number"
            id="periods"
            formControlName="periods"
            class="w-full px-3 py-2 text-sm sm:text-base border border-gray-300 rounded-md focus:outline-none transition-all duration-200"
            min="1"
            max="365"
          >
          <span class="ml-2 hidden sm:inline text-gray-600 text-sm">days</span>
        </div>
        <div *ngIf="predictionForm.get('periods')?.invalid && predictionForm.get('periods')?.touched" class="text-red-500 text-xs sm:text-sm mt-1">
          Please enter a number between 1 and 365
        </div>
      </div>

      <!-- Button -->
      <button
        type="submit"
        class="w-full mt-4 sm:mt-6 bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-2 sm:py-3 px-4 rounded-md transition-colors duration-300 disabled:bg-emerald-300 disabled:cursor-not-allowed focus:outline-none"
        [disabled]="predictionForm.invalid || loading"
      >
        <div class="flex items-center justify-center">
          <svg *ngIf="loading" class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          <span *ngIf="!loading">Generate Predictions</span>
          <span *ngIf="loading">Processing...</span>
        </div>
      </button>
    </form>
  </section>

  <!-- Right Side - SDGs Card -->
  <section class="w-full lg:w-2/5 bg-white rounded-lg shadow-lg p-4 sm:p-6 h-fit">
    <h2 class="text-xl font-semibold text-emerald-700 mb-4">Impacted Sustainable Development Goals</h2>
    
    <div *ngIf="selectedMetricImpacts" class="space-y-4">
      <div *ngFor="let sdg of selectedMetricImpacts" class="flex items-start gap-3 p-3 bg-gray-50 rounded-md border border-gray-200">
        <img [src]="'../../../../assets/images/sdgs/sdg-' + sdg.number + '.png'" [alt]="'SDG ' + sdg.number" class="w-12 h-12">
        <div>
          <p class="font-medium text-sm text-emerald-800">{{ sdg.title }}</p>
          <p class="text-xs text-gray-600 mt-1">{{ sdg.description }}</p>
        </div>
      </div>
    </div>
    
    <div *ngIf="!selectedMetricImpacts || !predictionForm.get('metric_type')?.value" class="text-sm text-gray-500 italic p-4 text-center border border-dashed border-gray-300 rounded-md">
      Select an indicator type to see impacted SDGs
    </div>
  </section>
</div>

<!-- Results Section -->
<app-prediction-results *ngIf="predictionResult" [predictionData]="predictionResult" class="w-full mx-auto"></app-prediction-results>